// DATOS: Aqu√≠ definimos todos los art√≠culos disponibles
const blogData = [
    {
        id: 1,
        titulo: "Los rincones del mundo que todo mochilero deber√≠a visitar en 2025",
        autor: "Carolina Monteamor",
        fecha: "25 Agosto, 2025",
        lectura: "5 min de lectura",
        imagenPrincipal: "assets/niklas-weiss--2WlTWZLnRc-unsplash.jpg",
        tag: "Destinos 2025",
        resumen: "Viajar con la mochila al hombro nunca pasa de moda. Cada a√±o aparecen nuevos rincones que se vuelven tendencia...",
        contenidoHTML: `
            <p class="lead-text">
                Viajar con la mochila al hombro nunca pasa de moda. Cada a√±o surgen nuevos destinos que despiertan la curiosidad de quienes buscan aventura, autenticidad y experiencias que dejen huella. El 2025 promete ser un a√±o lleno de oportunidades para los mochileros del mundo.
            </p>

            <p>
                Desde rutas poco transitadas en Asia hasta paisajes naturales intactos en Am√©rica del Sur, pasando por aldeas europeas que parecen detenidas en el tiempo. A continuaci√≥n, te presentamos algunos de los rincones m√°s sorprendentes que deber√≠as incluir en tu lista de viajes este a√±o.
            </p>

            <h2>1. Ubud y los Arrozales de Bali, Indonesia</h2>
            <p>
                Aunque Bali es un destino conocido, alejarse de las zonas m√°s tur√≠sticas de Kuta y adentrarse en el coraz√≥n de Ubud sigue siendo una experiencia transformadora. Los arrozales de Tegallalang ofrecen un paisaje verde esmeralda que parece sacado de una pintura.
            </p>
            
            <figure class="article-inline-image">
                <img src="assets/niklas-weiss--2WlTWZLnRc-unsplash.jpg" alt="Arrozales de Bali">
                <figcaption>Los impresionantes arrozales de Tegallalang en Ubud.</figcaption>
            </figure>

            <p>
                Para el mochilero, Ubud es el punto de partida ideal para explorar templos escondidos, practicar yoga en medio de la selva y conectar con la cultura local de una manera profunda y respetuosa. No olvides visitar el Monkey Forest, pero ¬°cuidado con tus pertenencias!
            </p>

            <blockquote>
                ‚ÄúViajar no es solo moverse de un lugar a otro, es cambiar tus ideas y prejuicios por experiencias reales.‚Äù
            </blockquote>

            <h2>2. La Ruta de los Balcanes</h2>
            <p>
                Europa del Este sigue siendo uno de los secretos mejor guardados y m√°s econ√≥micos para los mochileros. Pa√≠ses como Albania, Montenegro y Bosnia ofrecen monta√±as espectaculares, playas de aguas cristalinas y ciudades con una historia fascinante, todo a una fracci√≥n del coste de Europa Occidental.
            </p>

            <h3>Consejos para el viajero sostenible</h3>
            <ul>
                <li>Utiliza transporte local siempre que sea posible.</li>
                <li>Lleva tu propia botella de agua reutilizable.</li>
                <li>Respeta las costumbres locales de vestimenta en templos.</li>
                <li>Apoya a los artesanos locales comprando directamente a ellos.</li>
            </ul>

            <p>
                Preparar tu mochila para el 2025 significa estar listo para lo inesperado. Recuerda que la mejor ruta es a veces la que no aparece en los mapas, sino la que te recomiendan los locales con una sonrisa.
            </p>

            <div class="share-section">
                <span>¬øTe gust√≥? Comp√°rtelo:</span>
                <div class="share-icons">
                    <a href="#"><i class="fa-brands fa-facebook"></i></a>
                    <a href="#"><i class="fa-brands fa-twitter"></i></a>
                    <a href="#"><i class="fa-brands fa-whatsapp"></i></a>
                </div>
            </div>
        `
    },
    {
    id: 2,
    titulo: "Los 10 destinos m√°s sorprendentes de la India",
    autor: "Adriana del R√≠o",
    fecha: "10 Septiembre, 2025",
    lectura: "7 min de lectura",
    imagenPrincipal: "assets/india.jpg",
    tag: "Asia",
    resumen: "La India es un continente en s√≠ mismo. Descubre los templos olvidados, las rutas de especias y los paisajes que desaf√≠an la imaginaci√≥n.",
    contenidoHTML: `
        <p class="lead-text">
            La India no es solo un pa√≠s; es un asalto a los sentidos. Es un lugar donde el caos y la calma coexisten en una danza eterna. Visitar la India en 2025 sigue siendo el rito de iniciaci√≥n definitivo para cualquier viajero que busque salir de su zona de confort.
        </p>

        <p>
            M√°s all√° del Taj Mahal y el Tri√°ngulo Dorado, existe una India profunda, llena de misticismo y paisajes que parecen de otro planeta. He seleccionado los 10 destinos que m√°s me impactaron en mi √∫ltima traves√≠a de tres meses, lugares donde la magia a√∫n reside en cada esquina.
        </p>

        <h2>1. Hampi: El Reino de las Piedras</h2>
        <p>
            Imagina un paisaje lunar salpicado de palmeras y templos antiguos. Hampi, en el estado de Karnataka, es surrealista. Las ruinas del imperio Vijayanagara se mezclan con enormes rocas que parecen haber sido colocadas por gigantes.
        </p>
        
        <figure class="article-inline-image">
            <img src="assets/ruinas_de_hampi.jpg" alt="Ruinas de Hampi al atardecer">
            <figcaption>El atardecer sobre el templo Virupaksha es un momento inolvidable.</figcaption>
        </figure>

        <p>
            Aqu√≠ el tiempo se detiene. Alquila una moto, cruza el r√≠o en una barca de bamb√∫ y explora el lado "hippie" de la isla, o pi√©rdete entre los monolitos del templo de Vittala.
        </p>

        <h2>2. Ladakh: El Peque√±o T√≠bet</h2>
        <p>
            Lejos del calor tropical del sur, en el extremo norte, se encuentra Ladakh. Rodeado por las cordilleras del Himalaya y el Karak√≥rum, este desierto fr√≠o ofrece monasterios budistas colgados de acantilados y carreteras que tocan las nubes.
        </p>

        <blockquote>
            ‚ÄúEn la India aprendes que el plan nunca es el plan. La India decide por ti, y siempre decide algo mejor de lo que imaginabas.‚Äù
        </blockquote>

        <h2>3. Varanasi: La Ciudad de la Luz</h2>
        <p>
            No es un destino f√°cil, pero es esencial. Varanasi es una de las ciudades habitadas m√°s antiguas del mundo. Navegar por el r√≠o Ganges al amanecer y observar los rituales de vida y muerte en los <em>ghats</em> es una experiencia que te cambia la perspectiva sobre la existencia.
        </p>

        <h2>4. Kerala y los Backwaters</h2>
        <p>
            Para recuperarte de la intensidad del norte, nada mejor que el sur. Navegar en una casa flotante (<em>houseboat</em>) por los canales de Alleppey es la definici√≥n de paz absoluta. Palmeras, arrozales y una cocina basada en el coco que es simplemente deliciosa.
        </p>

        <h3>Consejos esenciales para tu viaje a la India</h3>
        <ul>
            <li><strong>El agua:</strong> Bebe siempre agua embotellada y evita el hielo en puestos callejeros.</li>
            <li><strong>Vestimenta:</strong> Lleva ropa modesta, especialmente al visitar templos. Un pa√±uelo siempre es √∫til.</li>
            <li><strong>Transporte:</strong> Usa la app de trenes india (IRCTC) para reservar con antelaci√≥n; las plazas vuelan.</li>
            <li><strong>Actitud:</strong> La paciencia ser√° tu mejor virtud. Sonr√≠e y d√©jate llevar.</li>
        </ul>

        <p>
            La lista se completa con joyas como Jaisalmer (la ciudad dorada), Rishikesh (la capital del yoga), o los puentes de ra√≠ces vivas en Meghalaya. La India te espera con los brazos abiertos y mil historias por contar. ¬øEst√°s listo para el viaje de tu vida?
        </p>

        <div class="share-section">
            <span>¬øTe inspir√≥ este art√≠culo? Comp√°rtelo:</span>
            <div class="share-icons">
                <a href="#"><i class="fa-brands fa-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-twitter"></i></a>
                <a href="#"><i class="fa-brands fa-whatsapp"></i></a>
            </div>
        </div>
    `
    },
    {
    id: 3,
    titulo: "Los secretos mejor guardados del mundo mochilero",
    autor: "Miguel √Ångel Soto",
    fecha: "05 Octubre, 2025",
    lectura: "4 min de lectura",
    imagenPrincipal: "assets/morten-andreassen-mX0tCOykgSY-unsplash.jpg",
    tag: "Consejos",
    resumen: "Ahorrar dinero, empacar ligero y conocer gente local. Te contamos los secretos de los expertos para viajar m√°s lejos con menos.",
    contenidoHTML: `
        <p class="lead-text">
            Hay una diferencia abismal entre ser turista y ser viajero. El turista exige que todo funcione como en casa; el viajero se adapta al caos. Tras a√±os de rutas, albergues y autobuses nocturnos, he recopilado esas "reglas no escritas" que todo mochilero experto conoce pero que rara vez aparecen en las gu√≠as convencionales.
        </p>

        <p>
            No se trata solo de ahorrar dinero (que tambi√©n), sino de optimizar la experiencia para vivir aventuras aut√©nticas sin el peso‚Äîliteral y figurado‚Äîde las preocupaciones innecesarias.
        </p>

        <h2>1. La regla de los 7 kilos</h2>
        <p>
            El error n√∫mero uno es llevar "por si acasos". El secreto mejor guardado es que <strong>puedes comprar casi todo lo que necesites en el destino</strong>, y a menudo, m√°s barato. Si tu mochila pesa m√°s de 10kg, est√°s cargando con miedos, no con ropa.
        </p>

        <div class="tip-box" style="background-color: #f8f9fa; border-left: 4px solid #333; padding: 15px; margin: 20px 0;">
            <strong>El truco del jab√≥n s√≥lido:</strong>
            Olvida los l√≠quidos. Una pastilla de jab√≥n tipo "Lagarto" o de coco sirve para: lavar tu ropa, ducharte, lavar los platos y hasta afeitarte. Ahorras espacio, peso y problemas en los controles del aeropuerto.
        </div>

        <h2>2. El arte de dormir en movimiento</h2>
        <p>
            El presupuesto de alojamiento suele ser el m√°s alto. Los expertos saben que moverse de noche es un 2x1: avanzas kil√≥metros y te ahorras la noche de hostal.
        </p>

        <figure class="article-inline-image">
            <img src="assets/tren_nocturno.jpg" alt="Tren nocturno en movimiento">
            <figcaption>Los trenes nocturnos en Asia no solo ahorran dinero, son una aventura social.</figcaption>
        </figure>

        <h2>3. Come donde comen los taxistas</h2>
        <p>
            Evita los restaurantes con cartas en ingl√©s y fotos de los platos en la puerta. Si quieres comida segura, barata y deliciosa, busca d√≥nde hay fila de locales. Mi regla de oro: si ves familias con ni√±os o taxistas comiendo ah√≠, la comida es fresca y buena.
        </p>

        <h2>4. Aplicaciones que salvan vidas (y dinero)</h2>
        <p>
            La tecnolog√≠a es tu aliada. M√°s all√° de Google Maps, aseg√∫rate de tener este kit digital:
        </p>
        
        <ul>
            <li><strong>Maps.me:</strong> Mapas offline. Imprescindible cuando no tienes se√±al en medio de la monta√±a.</li>
            <li><strong>XE Currency:</strong> Para saber exactamente cu√°nto est√°s pagando y evitar estafas en el cambio.</li>
            <li><strong>Splitwise:</strong> Si viajas con amigos, es la √∫nica forma de mantener las cuentas claras y la amistad intacta.</li>
        </ul>

        <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">

        <h3>El Manifiesto del Buen Mochilero</h3>
        <p>
            Para terminar, recuerda que eres un embajador de tu cultura.
        </p>
        <blockquote>
            ‚ÄúSonr√≠e siempre, incluso cuando no entiendas el idioma. Una sonrisa es el √∫nico pasaporte que no caduca y abre m√°s puertas que el dinero.‚Äù
        </blockquote>

        <p>
            Viajar ligero te da libertad. Viajar lento te da perspectiva. Y viajar con la mente abierta te da historias que contar√°s el resto de tu vida.
        </p>

        <div class="share-section">
            <span>¬øTienes alg√∫n secreto viajero? Comp√°rtelo:</span>
            <div class="share-icons">
                <a href="#"><i class="fa-brands fa-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-twitter"></i></a>
                <a href="#"><i class="fa-brands fa-whatsapp"></i></a>
            </div>
        </div>
        `
    },
    {
    id: 4,
    titulo: "Los nuevos para√≠sos mochileros que deber√≠as conocer",
    autor: "Javier Navarro",
    fecha: "12 Noviembre, 2025",
    lectura: "6 min de lectura",
    imagenPrincipal: "assets/andrew-ridley-Kt5hRENuotI-unsplash.jpg",
    tag: "Naturaleza",
    resumen: "Si buscas desconexi√≥n total, estos parques naturales y playas v√≠rgenes son para ti. Lugares donde el Wi-Fi no llega, pero la conexi√≥n es total.",
    contenidoHTML: `
        <p class="lead-text">
            Parece que el mundo se ha hecho m√°s peque√±o. Abres Instagram y ves la misma foto de la misma playa una y otra vez. Pero si sabes d√≥nde mirar, el planeta todav√≠a guarda rincones salvajes, pulmones verdes y aguas turquesas donde la √∫nica huella en la arena ser√° la tuya.
        </p>

        <p>
            Este 2025, la tendencia no es ir a donde van todos, sino ir a donde la naturaleza manda. He seleccionado tres destinos emergentes que est√°n redefiniendo el concepto de "para√≠so" para el mochilero consciente.
        </p>

        <h2>1. Svaneti, Georgia: Las torres entre glaciares</h2>
        <p>
            Olvida los Alpes por un momento. En el C√°ucaso georgiano, la regi√≥n de Svaneti ofrece un paisaje dram√°tico de picos nevados y prados alpinos salpicados de antiguas torres defensivas medievales (koshki).
        </p>

        <figure class="article-inline-image">
            <img src="assets/monta√±as_del_caucaso.jpg" alt="Monta√±as del C√°ucaso en Georgia">
            <figcaption>Mestia y Ushguli: aldeas donde el tiempo se detuvo hace siglos.</figcaption>
        </figure>

        <p>
            Es el destino perfecto para el senderismo duro y puro. Aqu√≠ no hay tiendas de souvenirs, solo aire limpio, hospitalidad ruda pero sincera y el famoso <em>khachapuri</em> (pan de queso) para reponer fuerzas tras la caminata.
        </p>

        <h2>2. Raja Ampat, Indonesia: El √∫ltimo ed√©n submarino</h2>
        <p>
            Si Bali es la fiesta, Raja Ampat es el templo. Ubicado en Pap√∫a Occidental, este archipi√©lago es biol√≥gicamente el lugar m√°s rico de la Tierra en vida marina. Llegar no es barato ni f√°cil (varios vuelos y ferris), lo que act√∫a como un filtro natural para el turismo de masas.
        </p>

        <div style="background-color: #e3f2fd; padding: 20px; border-radius: 8px; margin: 25px 0;">
            <h4 style="margin-top: 0; color: #0d47a1;"> El dato curioso</h4>
            <p style="margin-bottom: 0;">
                En estas aguas habitan el 75% de las especies de coral conocidas en el mundo. Bucear aqu√≠ es como nadar dentro de un documental de alta definici√≥n.
            </p>
        </div>

        <h2>3. La Guajira, Colombia: Donde el desierto besa al mar</h2>
        <p>
            En el extremo norte de Sudam√©rica, el desierto se encuentra con el Caribe. No esperes resorts; aqu√≠ se duerme en chinchorros (hamacas tejidas a mano) bajo un cielo con m√°s estrellas de las que cre√≠as que exist√≠an. Es tierra de la cultura Way√∫u, un lugar de vientos fuertes y contrastes naranjas y azules imposibles.
        </p>

        <blockquote>
            ‚ÄúNo heredamos la tierra de nuestros antepasados, la tomamos prestada de nuestros hijos.‚Äù ‚Äî Proverbio nativo americano
        </blockquote>

        <figure class="article-inline-image">
            <img src="assets/colombia_desierto.jpg" alt="Desierto de La Guajira en Colombia">
            <figcaption>La Guijara Colombia</figcaption>
        </figure>

        <h3>Tu Check-list de Viajero Sostenible</h3>
        <p>
            Visitar estos para√≠sos conlleva una responsabilidad. Antes de partir, aseg√∫rate de cumplir con estos tres mandamientos:
        </p>

        <ul class="check-list" style="list-style: none; padding-left: 0;">
            <li style="margin-bottom: 10px;">‚úÖ <strong>Cero Pl√°stico:</strong> Lleva botella con filtro y bolsas de tela. En islas remotas, el pl√°stico que llevas se queda all√≠ para siempre.</li>
            <li style="margin-bottom: 10px;">‚úÖ <strong>Respeta la Fauna:</strong> Nunca toques corales ni alimentes animales silvestres para la foto.</li>
            <li style="margin-bottom: 10px;">‚úÖ <strong>Econom√≠a Local:</strong> Paga el precio justo. El regateo agresivo en comunidades rurales no es ahorro, es explotaci√≥n.</li>
        </ul>

        <p>
            La naturaleza nos est√° llamando a volver a lo b√°sico. Estos destinos no son para que los consumas, son para que los cuides mientras ellos te curan a ti.
        </p>

        <div class="share-section">
            <span>¬øCu√°l es tu para√≠so so√±ado? Cu√©ntanoslo:</span>
            <div class="share-icons">
                <a href="#"><i class="fa-brands fa-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-twitter"></i></a>
                <a href="#"><i class="fa-brands fa-whatsapp"></i></a>
            </div>
        </div>
        `
    },
    {
    id: 5,
    titulo: "La vuelta al mundo en 80 platos: Comida callejera imperdible",
    autor: "Marta Gim√©nez",
    fecha: "18 Diciembre, 2025",
    lectura: "5 min de lectura",
    imagenPrincipal: "assets/street_market.jpg",
    tag: "Gastronom√≠a",
    resumen: "Olv√≠date de los restaurantes de mantel blanco. La verdadera cultura de un pa√≠s se hierve, se fr√≠e y se sirve en las aceras.",
    contenidoHTML: `
        <p class="lead-text">
            Hay dos tipos de viajeros: los que comen para sobrevivir y los que viajan para comer. Si eres de los segundos, sabes que el alma de una ciudad no est√° en sus museos, sino en el humo que sale de sus puestos callejeros a las siete de la tarde.
        </p>

        <p>
            Comer en la calle es un acto de fe y, sobre todo, de inmersi√≥n cultural. Es barato, es r√°pido y, a menudo, es mucho m√°s fresco que en cualquier hotel. Aqu√≠ tienes mis tres paradas gastron√≥micas favoritas de este 2025.
        </p>

        <h2>1. Bangkok, Tailandia: La capital mundial del sabor</h2>
        <p>
            En Chinatown (Yaowarat), el caos es delicioso. No puedes irte sin probar un <em>Pad Thai</em> aut√©ntico cocinado en un wok a fuego vivo o el desafiante <em>Durian</em> si te sientes valiente.
        </p>

        <figure class="article-inline-image">
            <img src="assets/bangkok_street_food.jpg" alt="Puesto de comida callejera en Bangkok">
            <figcaption>El chef callejero de Bangkok: un espect√°culo de fuego y destreza.</figcaption>
        </figure>

        <h2>2. Ciudad de M√©xico: El imperio del taco</h2>
        <p>
            Desde los tacos al pastor girando en su trompo hasta los esquites con mayonesa y chile. La regla aqu√≠ es sencilla: donde veas gente de pie sosteniendo un plato con una bolsita de pl√°stico, ah√≠ es.
        </p>

        <div style="border: 2px dashed #ff5722; padding: 20px; border-radius: 10px; margin: 30px 0; background-color: #fff3e0;">
            <h4 style="margin-top: 0; color: #d84315;">üî• El √≠ndice de picante</h4>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="padding: 5px;"><strong>Pica poco:</strong></td>
                    <td>"Salsa verde" (a veces)</td>
                </tr>
                <tr>
                    <td style="padding: 5px;"><strong>Pica rico:</strong></td>
                    <td>Salsa roja / Chipotle</td>
                </tr>
                <tr>
                    <td style="padding: 5px;"><strong>Llorar√°s:</strong></td>
                    <td>Habanero</td>
                </tr>
            </table>
        </div>

        <h2>3. Estambul, Turqu√≠a: Entre dos continentes</h2>
        <p>
            Nada supera caminar por el puente de G√°lata comiendo un <em>Balik Ekmek</em> (bocadillo de pescado) reci√©n hecho, mientras escuchas la llamada a la oraci√≥n al atardecer.
        </p>

        <h3>Reglas de oro para un est√≥mago feliz</h3>
        <p>
            Comer en la calle es seguro si sigues el sentido com√∫n. Aqu√≠ tienes mi mantra personal:
        </p>
        
        <ul>
            <li><strong>Fuego alto:</strong> Aseg√∫rate de que cocinen la comida delante de ti. El calor mata todo.</li>
            <li><strong>Rotaci√≥n alta:</strong> Ve al puesto con la fila m√°s larga. Significa que la comida no lleva horas ah√≠ parada.</li>
            <li><strong>Sin hielo:</strong> Si el agua no es potable en el pa√≠s, el hielo tampoco lo es.</li>
        </ul>

        <p>
            As√≠ que la pr√≥xima vez, guarda la gu√≠a de restaurantes de moda y sigue a tu olfato. ¬°Buen provecho!
        </p>

        <div class="share-section">
            <span>¬øCu√°l fue tu mejor comida callejera?</span>
            <div class="share-icons">
                <a href="#"><i class="fa-brands fa-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-twitter"></i></a>
                <a href="#"><i class="fa-brands fa-whatsapp"></i></a>
            </div>
        </div>
        `
    }

];
    
function renderBlogList(container, data = blogData) {
    container.innerHTML = "";
    if (data.length === 0) {
        container.innerHTML = `<div style="text-align: center; padding: 40px; color: #666; width: 100%;"><h3 data-i18n="blog.no_results_title"></h3><p data-i18n="blog.no_results_text"></p></div>`;
        if (window.i18n) {
            window.i18n.run();
        }
        return;
    }

    container.innerHTML = data.map(post => `
        <article class="blog-card">
            <div class="blog-image"><img src="${post.imagenPrincipal}" alt="${post.titulo}" loading="lazy"></div>
            <div class="blog-content">
                <h3 data-i18n="data_blog.id_${post.id}.title">${post.titulo}</h3>
                <p class="blog-author"><span data-i18n="blog.by"></span> ${post.autor}</p>
                <p class="blog-excerpt" data-i18n="data_blog.id_${post.id}.summary">${post.resumen}</p>
                <a href="blog_post.html?id=${post.id}" class="btn-black-sm" data-i18n="blog.read_more">Leer</a>
            </div>
        </article>
    `).join('');
    
    if (window.i18n) {
        window.i18n.run();
    }
}

function loadBlogPost() {
    const id = parseInt(new URLSearchParams(window.location.search).get("id"));
    const post = blogData.find(p => p.id === id);
    if (!post) {
        return;
    }

    const setText = (id, txt, key) => {
        const el = document.getElementById(id);
        if(el) { 
            el.textContent = txt; 
            if(key) el.setAttribute("data-i18n", key); 
        }
    };

    setText("post-tag", post.tag, `categories.${post.tag}`);
    setText("post-title", post.titulo, `data_blog.id_${post.id}.title`);
    document.getElementById("post-author").innerHTML = `<i class="fa-regular fa-user"></i> <span data-i18n="blog.by"></span> ${post.autor}`;
    document.getElementById("post-date").innerHTML = `<i class="fa-regular fa-calendar"></i> ${post.fecha}`;
    document.getElementById("post-time").innerHTML = `<i class="fa-regular fa-clock"></i> ${post.lectura}`;
    document.getElementById("post-content").innerHTML = post.contenidoHTML;

    document.querySelector(".sticky-article-hero").style.backgroundImage = `linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('${post.imagenPrincipal}')`;

    const related = document.getElementById("related-posts-container");
    if (related) {
        related.innerHTML = blogData.filter(p => p.id !== id).slice(0, 2).map(s => `
            <a href="blog_post.html?id=${s.id}" class="related-card">
                <img src="${s.imagenPrincipal}" alt="${s.titulo}">
                <h4 data-i18n="data_blog.id_${s.id}.title">${s.titulo}</h4>
            </a>
        `).join('');
    }
    if (window.i18n) {
        window.i18n.run();
    }
}

function initBlogFilters(container) {
    const input = document.querySelector(".search-input-container input");
    const state = { text: "", cat: "Todas las categor√≠as", order: "M√°s recientes" };

    const apply = () => {
        let res = blogData.filter(p => {
            const txtMatch = p.titulo.toLowerCase().includes(state.text) || p.resumen.toLowerCase().includes(state.text);
            const catMatch = state.cat === "Todas las categor√≠as" || p.tag === state.cat;
            return txtMatch && catMatch;
        });

        const parseDate = (str) => {
            const parts = str.replace(',', '').split(' ');
            return new Date(parts[2], ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"].indexOf(parts[1]), parts[0]);
        };

        if (state.order === "M√°s recientes") { res.sort((a,b) => parseDate(b.fecha) - parseDate(a.fecha)); }
        else if (state.order === "M√°s antiguos") { res.sort((a,b) => parseDate(a.fecha) - parseDate(b.fecha)); }
        else if (state.order === "A-Z") { res.sort((a,b) => a.titulo.localeCompare(b.titulo)); }
        else if (state.order === "Z-A") { res.sort((a,b) => b.titulo.localeCompare(a.titulo)); }

        renderBlogList(container, res);
    };

    if (input) {
        input.addEventListener("input", (e) => { 
            state.text = e.target.value.toLowerCase().trim(); 
            apply(); 
        });
    }

    const setupMenu = (btnCls, opts, cb) => {
        const btn = document.querySelector(btnCls);
        if (!btn) {
            return;
        }
        
        const menu = document.createElement("div");
        menu.className = "category-dropdown";
        
        opts.forEach(o => {
            const item = document.createElement("div");
            item.className = "category-option";
            item.textContent = o;
            item.onclick = () => { 
                cb(o); 
                menu.classList.remove("show"); 
                if(btnCls.includes("icon")) {
                    btn.classList.remove("active"); 
                } else {
                    btn.textContent = o; 
                }
            };
            menu.appendChild(item);
        });
        
        document.querySelector(".filter-buttons").appendChild(menu);
        
        btn.onclick = (e) => {
            e.stopPropagation();
            document.querySelectorAll(".category-dropdown").forEach(m => {
                if (m !== menu) m.classList.remove("show");
            });
            menu.classList.toggle("show");
            
            if(btnCls.includes("icon")) {
                btn.classList.toggle("active");
            }
        };
    };

    setupMenu(".filter-btn", ["Todas las categor√≠as", ...new Set(blogData.map(p => p.tag))], (sel) => { state.cat = sel; apply(); });
    setupMenu(".filter-icon-btn", ["M√°s recientes", "M√°s antiguos", "A-Z", "Z-A"], (sel) => { state.order = sel; apply(); });

    document.addEventListener("click", () => {
        document.querySelectorAll(".category-dropdown").forEach(m => m.classList.remove("show"));
    });
}

// --- INIT ---
function init() {
    const listContainer = document.querySelector(".blog-list-container");
    const indexContainer = document.getElementById("index-blog-container");
    const isPostPage = document.querySelector(".article-body");

    if (listContainer) {
        renderBlogList(listContainer);
        initBlogFilters(listContainer);
    } else if (indexContainer) {
        renderBlogList(indexContainer, blogData.slice(0, 2));
    } else if (isPostPage) {
        loadBlogPost();
    }
}

init();